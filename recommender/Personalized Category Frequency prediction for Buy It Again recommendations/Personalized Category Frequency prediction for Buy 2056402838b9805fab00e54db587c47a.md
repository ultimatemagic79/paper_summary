# Personalized Category Frequency prediction for Buy It Again recommendations

読み中: 進行中
著者: Amit Pande
発行年: 2023
学会名: RecSys
URL: https://dl.acm.org/doi/10.1145/3604915.3608822
Readable: Personalized%20Category%20Frequency%20prediction%20for%20Buy%202056402838b9805fab00e54db587c47a/Personalized_Category_Frequency_Prediction_(1).pdf
要約: 「前に買ったあの商品、そろそろ切れそうだから教えて！」というニーズに応える Buy It Again 推薦を、
• アイテムではなくカテゴリ（牛乳・シャンプーなど）単位で先に予測
• その後でカテゴリ内の具体的なアイテムを並べる

という 2 段構えのモデル PCIC を提案。カテゴリに着目することで、アイテム数・ユーザ数が桁違いに多い大規模 EC でも学習が可能になり、精度も向上した。
GPT: https://chatgpt.com/share/683c11ef-e14c-800c-938e-768c4557a8ec

### キーワード

パーソナライズド推薦 / E-コマース / リピート購買 / Buy It Again (BIA) / サバイバル分析 / 時系列モデル（ARIMA） / ニューラルネットワーク

---

### 概要（初心者向けに一言で）

**Buy It Again Recommend：**顧客が再度購入する可能性の高い商品を提案する

- **アイテム**ではなく**カテゴリ**（牛乳・シャンプーなど）単位で先に予測
- その後でカテゴリ内の具体的なアイテムを並べる
    
    という 2 段構えのモデル **PCIC** を提案。カテゴリに着目することで、アイテム数・ユーザ数が桁違いに多い大規模 EC でも学習が可能になり、精度も向上した。
    

### 研究背景

- リピート購買はECサイトにおいて、消耗品カテゴリは再度購入される確率が高い
- AmazonなどのECサイトにはBuy It Againがあり、そろそろ買い足す商品をレコメンドしているためBuy It Againはとても重要
- 既存研究ではRNNなどで商品再購入の確率の計算に焦点を当てており，大手の場合には計算量も多く，スパースになるため実行が難しい

### 論文の肝

- **カテゴリレベルの再購入モデリングの導入**
    - アイテム単位ではデータが疎で予測が難しい
    - 異なるブランドを試したい、代替品の割引など，カテゴリ内の新しい品目を顧客は求めることが多いため，理にかなっている
1. **カテゴリ再購買確率をどう推定するか**
    - **サバイバル分析**で「前回購入から何日後に再購入しそうか」を集団統計で捉える。
    - **ARIMA**で個々のユーザの消費ペースを短期予測。
    - これらを特徴量に簡素な 2 層 NN を学習 ― 軽量で 1 億ユーザ規模でも 8 時間で学習完了。
- **オンライン A/B テストで実証**
    - CTR +6 %、コンバージョン +8.5 %、購入点数 +27.5 % と実ビジネス指標を大きく改善。

---

### 手法

- **PC (Personalized Category)**
    - 次に買うカテゴリを確率で当てる
    - 特徴量
        - サバイバル統計量：カテゴリ全体として何日間で再購入されがちか
        - ARIMA（自己回帰積分移動平均）モデル：購入した品目の数量を検討し，個人がどのペースで消費しているかを予測
        - その他行動特徴
    - 計11の特徴量をもとに軽量なNNモデルでカテゴリを予測する
- **IC (Items-within-Category)**
    - ユーザがそのアイテムを買った回数順
    - 最後に買った時点からの経過順
    - カテゴリ全体の販売順位
    - 以上3つから加重平均で統合し，カテゴリ内のアイテムの順位をつける

最終的な推薦リストは PC で選んだカテゴリをラウンドロビンで回しつつ、各カテゴリの上位アイテム（IC）を挿入して生成。

---

![スクリーンショット 2025-06-04 18.28.48.png](Personalized%20Category%20Frequency%20prediction%20for%20Buy%202056402838b9805fab00e54db587c47a/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2025-06-04_18.28.48.png)

![image.png](Personalized%20Category%20Frequency%20prediction%20for%20Buy%202056402838b9805fab00e54db587c47a/image.png)

![image.png](Personalized%20Category%20Frequency%20prediction%20for%20Buy%202056402838b9805fab00e54db587c47a/image%201.png)

### 実験内容

- データセット
    - ValuedShopper
    - Instacart
    - Dunnhumby
    - TaFeng
    - 内部データセット
- 指標
    - Recall(@k)
    - NDCG(@k)
- ベースライン
    - TopSell: 全ユーザから購入された最も頻度の高い商品を全ユーザへの推薦
    - FBought: 個別のユーザによって購入された最も頻度の高い商品を推薦
    - userKNN: kNNに基づく古典的協調フィルタリング
    - その他既存手法
- 性能比較
    - PCICはRecallとHDCGともに高い性能を発揮している
    - TIFUKNNがRecallでは良い結果に
        - このモデルはカテゴリではなくアイテム頻度を明示的に学習している
    - その他アイテム頻度やカテゴリ頻度を細くしないモデルより高い性能を発揮していることがわかった
    - 大規模データセットではTIFUKNNはそもそも計算不能になった
    - PCICはNDCGでは良い結果を残していることがわかった
- A/Bテスト
    - ベースラインはFBought
    - CTRが6%，Conversionが9%，Unitsが27.5%向上したことがわかった

---

### まとめ

- Buy It Again推薦に対し，カテゴリ→アイテムと段階を踏んだ推論を行った
- 大規模なデータに対しても実用性の高い計算量であった
- A/Bテストで高い効果を実証した

---

### 所感

- ECサイトでは再購入という文脈があり，それに対して段階を踏んだ推論を構築するのは割と理にかなっていて参考になった
- 他のレコメンドにおいても、再来店などにおいてBuy It Againの文脈が使用できて、同ジャンルの店→店のランク付けといった形で使用できそう